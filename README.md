# Polygon Miter Offset Algorithm

Це моя реалізація алгоритму для побудови офсету багатокутника. Працює в режимі **Miter Join**: тобто зберігає кути гострими, знаходячи точні точки перетину нових граней.

Код написаний на чистому **Python**, без використання бібліотек типу Shapely. Для візуалізації я використав `matplotlib`.

## Що реалізовано

* **Miter Offset:** Алгоритм будує контур, зберігаючи оригінальну геометрію кутів (без заокруглень).
* **Expand & Shrink:** Працює в обидва боки. Розширення (`d > 0`) та стискання (`d < 0`).
* **Auto-Orientation:** Код сам визначає, в який бік записані вершини (за годинниковою чи проти), і адаптує нормалі, щоб офсет завжди йшов у правильному напрямку.

## Як працює алгоритм

В основі лежить аналітична геометрія. Я розділив логіку на 4 етапи:

### 1. Підготовка (Нормалі та Орієнтація)

Щоб знати, куди зсувати стіну, треба знати її перпендикуляр (нормаль). Головна складність тут: зрозуміти, де у фігури "зовні", а де "всередині", щоб не переплутати напрямок.

Я використовую **Shoelace Formula**, щоб автоматично визначити орієнтацію полігону (CW або CCW). Залежно від цього я обираю правильний знак для нормалі.

### 2. Зсув ліній (Offsetting)

Замість того, щоб працювати з відрізками, я розглядаю кожне ребро як нескінченну пряму у загальному вигляді: `Ax + By = C`

Зсув відбувається простою зміною коефіцієнта `C`.

### 3. Пошук нових вершин (Intersection)

Точка перетину двох зміщених прямих сусідніх ребер це і є нова вершина. Щоб знайти цю точку `(x, y)`, я розв'язую систему лінійних рівнянь методом **Крамера**.

### 4. Обробка колізій (Topology Cleanup)

Це була найскладніша частина. Коли ми стискаємо фігуру (`d < 0`), вона може поводитися непередбачувано. Мій алгоритм робить наступне:

* **Detection:** Проходить по нових точках і шукає місця, де лінія перетнула сама себе.
* **Splitting:** Якщо фігура перетиснулася (наприклад, U-подібна форма розпалася на дві "ніжки"), алгоритм знаходить точку перетину, вирізає зайве та повертає набір окремих замкнених полігонів.
* **Cleaning:** Якщо фігура "схлопнулася" (площа стала нульовою або від'ємною), вона відфільтровується.

## Структура проекту

* `base.py` — Геометричні примітиви: `Point`, `Vector`, `Line`. Тут живе математика перетинів та нормалей.
* `polygon.py` — Основна логіка: клас `Polygon` та стратегія `MiterOffsetStrategy`
* `offset_service.py` — Сервісний шар для зручного виклику.
* `main.py` — Точка входу. Містить тестові кейси та код для графіків.

## Запуск

1. Встановіть matplotlib:
   **Bash**

   ```
   pip install matplotlib
   ```
2. Запустіть скрипт:
   **Bash**

   ```
   python main.py
   ```

Скрипт відкриє вікно з 6 графіками, які демонструють різні сценарії: розширення, створення отворів, повне зникнення фігури та складний випадок розпаду на частини (Split).
